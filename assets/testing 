Thatâ€™s a great idea! Moving the Allure report generation and opening logic to a dedicated script in package.json keeps your WebdriverIO config cleaner, more maintainable, and reusable across CI/CD and local runs. ğŸš€


---

âœ… Steps to Implement This Clean Approach

1ï¸âƒ£ Modify package.json to Add Scripts

Add these scripts inside "scripts" in package.json:

"scripts": {
  "generate-allure-report": "npx allure generate --single-file --clean -o reports/allure-report reports/allure/allure-results",
  "open-allure-report": "npx allure open reports/allure-report"
}

2ï¸âƒ£ Modify wdio.conf.ts

Now, in wdio.conf.ts, replace the execFileSync calls with this:

import { execFileSync } from 'child_process';

export const config: WebdriverIO.Config = {
  onComplete() {
    console.log('âœ… All tests completed! Generating Allure report...');

    try {
      // Run the new package.json script instead of manually calling execFileSync
      execFileSync('npm', ['run', 'generate-allure-report'], { stdio: 'inherit' });

      console.log('âœ… Allure report generated. You can open it manually with:');
      console.log('ğŸ‘‰ npm run open-allure-report');

    } catch (error) {
      console.error('âŒ Error generating Allure report:', error);
    }
  }
};


---

ğŸ”¹ Why This Approach is Better?

âœ” Keeps wdio.conf.ts cleaner â€“ No need for inline shell commands.
âœ” Easier to maintain â€“ Scripts are reusable in CI/CD and local environments.
âœ” Improves CI/CD flexibility â€“ CI can generate the report but not force-open it, letting developers open it if needed.
âœ” Avoids OS-specific logic (cmd start, open, xdg-open) â€“ Instead, users run npm run open-allure-report themselves.


---

ğŸš€ Next Steps

1ï¸âƒ£ Update package.json with the new scripts.
2ï¸âƒ£ Modify wdio.conf.ts to use execFileSync('npm', ['run', 'generate-allure-report']).
3ï¸âƒ£ Run your tests and confirm:

npm run test:e2e

4ï¸âƒ£ After test completion, manually open the report with:

npm run open-allure-report

5ï¸âƒ£ For CI/CD Pipelines â€“ Just use:

npm run generate-allure-report


---

ğŸ“Œ Summary

âœ… Removed inline shell commands from wdio.conf.ts.
âœ… Delegated report generation & opening to package.json scripts.
âœ… CI/CD now only generates the report, and users can open it manually.

This keeps things clean, structured, and easily maintainable! ğŸš€ Let me know if you need any tweaks.

